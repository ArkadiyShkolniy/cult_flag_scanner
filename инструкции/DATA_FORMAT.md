# –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

–î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```
neural_network/
‚îî‚îÄ‚îÄ data/
    ‚îú‚îÄ‚îÄ candles/                    # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å CSV —Ñ–∞–π–ª–∞–º–∏ —Å–≤–µ—á–µ–π
    ‚îÇ   ‚îú‚îÄ‚îÄ vkco_1h_20240101_120000.csv
    ‚îÇ   ‚îú‚îÄ‚îÄ sber_1h_20240101_130000.csv
    ‚îÇ   ‚îú‚îÄ‚îÄ gazp_1d_20240101_000000.csv
    ‚îÇ   ‚îî‚îÄ‚îÄ ...
    ‚îî‚îÄ‚îÄ annotations.csv             # –§–∞–π–ª —Å –º–µ—Ç–∫–∞–º–∏ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

---

## üìä –§–æ—Ä–º–∞—Ç CSV —Ñ–∞–π–ª–æ–≤ —Å–æ —Å–≤–µ—á–∞–º–∏

–ö–∞–∂–¥—ã–π CSV —Ñ–∞–π–ª –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `candles/` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---------|-----|----------|--------|
| `time` | datetime/string | –í—Ä–µ–º—è —Å–≤–µ—á–∏ | `2024-01-01 10:00:00` |
| `open` | float | –¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è | `150.50` |
| `high` | float | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ | `152.30` |
| `low` | float | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ | `149.80` |
| `close` | float | –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è | `151.20` |
| `volume` | int/float | –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ | `1000000` |

### –ü—Ä–∏–º–µ—Ä CSV —Ñ–∞–π–ª–∞:

```csv
time,open,high,low,close,volume
2024-01-01 10:00:00,150.50,152.30,149.80,151.20,1000000
2024-01-01 11:00:00,151.20,152.00,150.50,151.80,950000
2024-01-01 12:00:00,151.80,153.50,151.00,153.20,1200000
2024-01-01 13:00:00,153.20,154.00,152.50,153.80,1100000
2024-01-01 14:00:00,153.80,154.50,153.00,153.50,1050000
...
```

### –í–∞–∂–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

1. **–ú–∏–Ω–∏–º—É–º —Å–≤–µ—á–µ–π**: –§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–≤–µ—á–µ–π –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 50-200 —Å–≤–µ—á–µ–π)
2. **–•—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫**: –°–≤–µ—á–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º)
3. **–ë–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤**: –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã (–Ω–µ—Ç NaN –∑–Ω–∞—á–µ–Ω–∏–π)
4. **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –¶–µ–Ω—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ (high >= low, high >= open, high >= close, –∏ —Ç.–¥.)

---

## üè∑Ô∏è –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ annotations.csv

–§–∞–π–ª `annotations.csv` —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –µ–≥–æ –≤—Ä—É—á–Ω—É—é. –§–æ—Ä–º–∞—Ç:

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---------|-----|----------|--------|
| `file` | string | **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π** –ø—É—Ç—å –∫ CSV —Ñ–∞–π–ª—É –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `data/` | `candles/vkco_1h_20240101_120000.csv` |
| `label` | int | –ú–µ—Ç–∫–∞ –∫–ª–∞—Å—Å–∞: 0=–Ω–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞, 1=–±—ã—á–∏–π, 2=–º–µ–¥–≤–µ–∂–∏–π | `1` |
| `ticker` | string | –¢–∏–∫–µ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ | `VKCO` |
| `timeframe` | string | –¢–∞–π–º—Ñ—Ä–µ–π–º | `1h`, `5m`, `1d` |
| `pattern_type` | string | –¢–∏–ø –ø–∞—Ç—Ç–µ—Ä–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | `FLAG_0_1_2_3_4` |
| `timestamp` | string | –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ | `2024-01-01T12:00:00` |
| `notes` | string | –ó–∞–º–µ—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | `–•–æ—Ä–æ—à–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω` |

### –ü—Ä–∏–º–µ—Ä annotations.csv:

```csv
file,label,ticker,timeframe,pattern_type,timestamp,notes
candles/vkco_1h_20240101_120000.csv,1,VKCO,1h,FLAG_0_1_2_3_4,2024-01-01T12:00:00,"Quality score: 85"
candles/sber_1h_20240101_130000.csv,2,SBER,1h,BEARISH_FLAG_0_1_2_3_4,2024-01-01T13:00:00,"–ú–µ–¥–≤–µ–∂–∏–π —Ñ–ª–∞–≥"
candles/gazp_1d_20240101_000000.csv,0,GAZP,1d,,2024-01-01T00:00:00,"–õ–æ–∂–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ —Å–∫–∞–Ω–µ—Ä–∞"
```

### –ú–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤:

- **`label = 0`**: –ù–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "–§–ª–∞–≥"
- **`label = 1`**: –ë—ã—á–∏–π —Ñ–ª–∞–≥ (Bullish Flag)
- **`label = 2`**: –ú–µ–¥–≤–µ–∂–∏–π —Ñ–ª–∞–≥ (Bearish Flag)

---

## üìù –ü—Ä–∏–º–µ—Ä—ã —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ç–æ—Ä

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ç–æ—Ä:

```python
from scanners.combined_scanner import ComplexFlagScanner
from neural_network.annotator import PatternAnnotator

scanner = ComplexFlagScanner(token)
annotator = PatternAnnotator()

# –°–∫–∞–Ω–∏—Ä—É–µ–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
df = scanner.get_candles_df('VKCO', 'TQBR', days_back=60)
patterns = scanner.analyze(df, timeframe='1h')

if patterns:
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç CSV –∏ –¥–æ–±–∞–≤–∏—Ç –≤ annotations.csv
    annotator.annotate_from_scanner(df, 'VKCO', '1h', patterns[0])
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç:
- `data/candles/vkco_1h_20240101_120000.csv` - —Ñ–∞–π–ª —Å–æ —Å–≤–µ—á–∞–º–∏
- –ó–∞–ø–∏—Å—å –≤ `data/annotations.csv` - –º–µ—Ç–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä—É—á–Ω—É—é

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –Ω—É–∂–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```python
import pandas as pd
from neural_network.annotator import PatternAnnotator

# –ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞—à–∏ —Å–≤–µ—á–∏
df = pd.read_csv('your_candles.csv')

# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–æ–ª–æ–Ω–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
required_columns = ['time', 'open', 'high', 'low', 'close', 'volume']
assert all(col in df.columns for col in required_columns), "–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏"

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —á–µ—Ä–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ç–æ—Ä
annotator = PatternAnnotator()
candles_file = annotator.save_candles(df, ticker='VKCO', timeframe='1h')

# –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∫—É
annotator.annotate_pattern(
    candles_file=candles_file,
    label=1,  # 1 = –±—ã—á–∏–π
    ticker='VKCO',
    timeframe='1h'
)
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –°–æ–∑–¥–∞–Ω–∏–µ annotations.csv –≤—Ä—É—á–Ω—É—é

–ï—Å–ª–∏ —É –≤–∞—Å –º–Ω–æ–≥–æ CSV —Ñ–∞–π–ª–æ–≤ —É–∂–µ –≥–æ—Ç–æ–≤—ã:

```python
import pandas as pd
from pathlib import Path

# –°–ø–∏—Å–æ–∫ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–æ–≤
files_info = [
    {'file': 'candles/vkco_1h_001.csv', 'label': 1, 'ticker': 'VKCO', 'timeframe': '1h'},
    {'file': 'candles/sber_1h_002.csv', 'label': 1, 'ticker': 'SBER', 'timeframe': '1h'},
    {'file': 'candles/gazp_1h_003.csv', 'label': 0, 'ticker': 'GAZP', 'timeframe': '1h'},
    {'file': 'candles/lkoh_1h_004.csv', 'label': 2, 'ticker': 'LKOH', 'timeframe': '1h'},
]

# –°–æ–∑–¥–∞–µ–º DataFrame
annotations = pd.DataFrame(files_info)
annotations['timestamp'] = pd.Timestamp.now().isoformat()
annotations['pattern_type'] = ''
annotations['notes'] = ''

# –°–æ—Ö—Ä–∞–Ω—è–µ–º
annotations.to_csv('neural_network/data/annotations.csv', index=False)
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```python
import pandas as pd
from pathlib import Path

data_dir = Path('neural_network/data')

# –ü—Ä–æ–≤–µ—Ä—è–µ–º annotations.csv
annotations = pd.read_csv(data_dir / 'annotations.csv')
print(f"–í—Å–µ–≥–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π: {len(annotations)}")
print(f"\n–ö–æ–ª–æ–Ω–∫–∏: {list(annotations.columns)}")
print(f"\n–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–∫:\n{annotations['label'].value_counts()}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º CSV —Ñ–∞–π–ª—ã
candles_dir = data_dir / 'candles'
errors = []

for csv_file in candles_dir.glob('*.csv'):
    try:
        df = pd.read_csv(csv_file)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–æ–Ω–æ–∫
        required = ['time', 'open', 'high', 'low', 'close', 'volume']
        missing = [col for col in required if col not in df.columns]
        if missing:
            errors.append(f"{csv_file.name}: –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏ {missing}")
            continue
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        if len(df) < 50:
            errors.append(f"{csv_file.name}: —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ —Å–≤–µ—á–µ–π ({len(df)})")
            continue
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ NaN
        if df[required].isna().any().any():
            errors.append(f"{csv_file.name}: –µ—Å—Ç—å –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è")
            continue
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ —Ü–µ–Ω
        invalid_prices = (
            (df['high'] < df['low']) |
            (df['high'] < df['open']) |
            (df['high'] < df['close']) |
            (df['low'] > df['open']) |
            (df['low'] > df['close'])
        ).any()
        
        if invalid_prices:
            errors.append(f"{csv_file.name}: –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ü–µ–Ω—ã")
        
    except Exception as e:
        errors.append(f"{csv_file.name}: –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ - {e}")

if errors:
    print("\n‚ùå –û—à–∏–±–∫–∏ –Ω–∞–π–¥–µ–Ω—ã:")
    for error in errors:
        print(f"  - {error}")
else:
    print("\n‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –≤–∞–ª–∏–¥–Ω—ã!")
```

---

## üìä –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–∞–Ω–Ω—ã—Ö

### –ú–∏–Ω–∏–º—É–º –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:

- **–ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å**: 50-100 –æ–±—Ä–∞–∑—Ü–æ–≤ (–º–∏–Ω–∏–º—É–º)
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: 200-300 –æ–±—Ä–∞–∑—Ü–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
- **–ò–¥–µ–∞–ª—å–Ω–æ**: 500+ –æ–±—Ä–∞–∑—Ü–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤:

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç:
- –ù–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞ (0): 40-50%
- –ë—ã—á–∏–π (1): 25-30%
- –ú–µ–¥–≤–µ–∂–∏–π (2): 25-30%

### –ü—Ä–∏–º–µ—Ä—ã:

```
–•–æ—Ä–æ—à–æ:
- –ù–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞: 400 –æ–±—Ä–∞–∑—Ü–æ–≤
- –ë—ã—á–∏–π: 250 –æ–±—Ä–∞–∑—Ü–æ–≤
- –ú–µ–¥–≤–µ–∂–∏–π: 250 –æ–±—Ä–∞–∑—Ü–æ–≤
–ò—Ç–æ–≥–æ: 900 –æ–±—Ä–∞–∑—Ü–æ–≤

–ü—Ä–∏–µ–º–ª–µ–º–æ:
- –ù–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞: 200 –æ–±—Ä–∞–∑—Ü–æ–≤
- –ë—ã—á–∏–π: 150 –æ–±—Ä–∞–∑—Ü–æ–≤
- –ú–µ–¥–≤–µ–∂–∏–π: 150 –æ–±—Ä–∞–∑—Ü–æ–≤
–ò—Ç–æ–≥–æ: 500 –æ–±—Ä–∞–∑—Ü–æ–≤

–ú–∏–Ω–∏–º—É–º:
- –ù–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞: 100 –æ–±—Ä–∞–∑—Ü–æ–≤
- –ë—ã—á–∏–π: 50 –æ–±—Ä–∞–∑—Ü–æ–≤
- –ú–µ–¥–≤–µ–∂–∏–π: 50 –æ–±—Ä–∞–∑—Ü–æ–≤
–ò—Ç–æ–≥–æ: 200 –æ–±—Ä–∞–∑—Ü–æ–≤
```

---

## üîÑ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –≤ –¥—Ä—É–≥–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –≤–æ—Ç –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:

### –ò–∑ DataFrame —Å–æ —Å–≤–µ—á–∞–º–∏:

```python
import pandas as pd

# –í–∞—à DataFrame (–º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –ª—é–±–æ–º —Ñ–æ—Ä–º–∞—Ç–µ)
your_df = pd.DataFrame({
    'datetime': [...],  # –í–∞—à–µ –≤—Ä–µ–º—è
    'open_price': [...],  # –í–∞—à–∞ —Ü–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è
    'max_price': [...],  # –í–∞—à –º–∞–∫—Å–∏–º—É–º
    # ...
})

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
df_for_training = pd.DataFrame({
    'time': your_df['datetime'],
    'open': your_df['open_price'],
    'high': your_df['max_price'],
    'low': your_df['min_price'],  # –∏–ª–∏ –≤–∞—à–∞ –∫–æ–ª–æ–Ω–∫–∞ –º–∏–Ω–∏–º—É–º–∞
    'close': your_df['close_price'],
    'volume': your_df['volume']
})

# –°–æ—Ö—Ä–∞–Ω—è–µ–º
df_for_training.to_csv('neural_network/data/candles/my_file.csv', index=False)
```

### –ò–∑ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

```python
# –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ API
def prepare_candles_from_api(api_data):
    """
    api_data - —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–≤–µ—á–µ–π
    """
    df = pd.DataFrame(api_data)
    
    # –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    df = df.rename(columns={
        'timestamp': 'time',
        'o': 'open',
        'h': 'high',
        'l': 'low',
        'c': 'close',
        'v': 'volume'
    })
    
    # –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ —Ç–∏–ø—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
    df['time'] = pd.to_datetime(df['time'])
    for col in ['open', 'high', 'low', 'close']:
        df[col] = df[col].astype(float)
    df['volume'] = df['volume'].astype(float)
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
    df = df.sort_values('time').reset_index(drop=True)
    
    return df
```

---

## üéØ –†–µ–∑—é–º–µ

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:**

1. ‚úÖ CSV —Ñ–∞–π–ª—ã —Å–æ —Å–≤–µ—á–∞–º–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `neural_network/data/candles/`
2. ‚úÖ –ö–æ–ª–æ–Ω–∫–∏: `time`, `open`, `high`, `low`, `close`, `volume`
3. ‚úÖ –§–∞–π–ª `annotations.csv` —Å –º–µ—Ç–∫–∞–º–∏ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ç–æ—Ä)
4. ‚úÖ –ú–∏–Ω–∏–º—É–º 200 –æ–±—Ä–∞–∑—Ü–æ–≤ (–ª—É—á—à–µ 500+)
5. ‚úÖ –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤

**–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±:**

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `PatternAnnotator.annotate_from_scanner()` - –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∫–∞–Ω–µ—Ä–∞.

