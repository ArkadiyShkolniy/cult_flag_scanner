# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 1D CNN

## ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

**–î–∞, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è 1D CNN!**

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

1. **annotations.csv** - —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∫–∏ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏:
   - `t0_idx`, `t0_price` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏ T0
   - `t1_idx`, `t1_price` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏ T1
   - `t2_idx`, `t2_price` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏ T2
   - `t3_idx`, `t3_price` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏ T3
   - `t4_idx`, `t4_price` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏ T4
   - `label` - –º–µ—Ç–∫–∞ –∫–ª–∞—Å—Å–∞ (1=–±—ã—á–∏–π, 2=–º–µ–¥–≤–µ–∂–∏–π)
   - `file` - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–æ —Å–≤–µ—á–∞–º–∏

2. **CSV —Ñ–∞–π–ª—ã —Å–æ —Å–≤–µ—á–∞–º–∏** - —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∞–Ω–Ω—ã–µ —Å–≤–µ—á–µ–π:
   - `time`, `open`, `high`, `low`, `close`, `volume`

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

**–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥ (CNN –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö):**
- –°–≤–µ—á–∏ ‚Üí –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 224x224 ‚Üí CNN
- –¢–µ—Ä—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏
- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ (matplotlib)

**–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ (1D CNN):**
- –°–≤–µ—á–∏ ‚Üí –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å [100, 5] ‚Üí 1D CNN
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å –¥–∞–Ω–Ω—ã–º–∏
- –ë—ã—Å—Ç—Ä–µ–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`data_loader_1d.py`** - –∑–∞–≥—Ä—É–∑—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è 1D CNN
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–≤–µ—á–∏ –Ω–∞–ø—Ä—è–º—É—é (–±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
   - –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫ [0, 1]
   - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–µ–∫ –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

2. **`model_1d.py`** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ 1D CNN
   - 1D —Å–≤–µ—Ä—Ç–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Å–∏
   - –î–≤–∞ –≤—ã—Ö–æ–¥–∞: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è + —Ä–µ–≥—Ä–µ—Å—Å–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ [batch, sequence_length, features]

3. **`train_1d.py`** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
   - –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
cd complex_flag_scanner/neural_network
python3 data_loader_1d.py
```

–î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:
- –†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞
- –ü—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–∏–º–µ—Ä –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python3 model_1d.py
```

–î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:
- –†–∞–∑–º–µ—Ä—ã –≤—Ö–æ–¥–æ–≤/–≤—ã—Ö–æ–¥–æ–≤
- –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ

### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python3 train_1d.py \
    --data_dir neural_network/data \
    --batch_size 32 \
    --epochs 50 \
    --lr 0.001 \
    --sequence_length 100 \
    --device cpu
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è:

- `--data_dir`: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `neural_network/data`)
- `--batch_size`: –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 32)
- `--epochs`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)
- `--lr`: Learning rate (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.001)
- `--sequence_length`: –î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 100)
- `--device`: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (cpu/cuda, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é cpu)

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥ –º–æ–¥–µ–ª–∏:
```python
sequence: [batch, sequence_length, features]
# sequence_length = 100 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π)
# features = 5 (open, high, low, close, volume)
```

### –í—ã—Ö–æ–¥ –º–æ–¥–µ–ª–∏:
```python
class_logits: [batch, 3]  # –ö–ª–∞—Å—Å—ã: –Ω–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞, –±—ã—á–∏–π, –º–µ–¥–≤–µ–∂–∏–π
keypoints: [batch, 5, 2]  # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–µ–∫ T0-T4 (x, y –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ 0-1)
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ 1D CNN:

1. **–°–∫–æ—Ä–æ—Å—Ç—å:**
   - –ù–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ matplotlib
   - –ë—ã—Å—Ç—Ä–µ–µ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
   - –ú–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏

2. **–¢–æ—á–Ω–æ—Å—Ç—å:**
   - –ù–µ—Ç –ø–æ—Ç–µ—Ä–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–∏ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏
   - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
   - –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

3. **–ì–∏–±–∫–æ—Å—Ç—å:**
   - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã)
   - –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –¥–ª–∏–Ω—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ü—Ä–æ—â–µ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å

### –ß—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:

1. **Data loader:** ‚úÖ –°–æ–∑–¥–∞–Ω `data_loader_1d.py`
2. **–ú–æ–¥–µ–ª—å:** ‚úÖ –°–æ–∑–¥–∞–Ω–∞ `model_1d.py`
3. **Trainer:** ‚úÖ –°–æ–∑–¥–∞–Ω `train_1d.py`
4. **Predict:** –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å `predict_1d.py` (–∞–Ω–∞–ª–æ–≥ `predict_keypoints.py`)

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å data loader:**
   ```bash
   python3 data_loader_1d.py
   ```

2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å:**
   ```bash
   python3 model_1d.py
   ```

3. **–û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å:**
   ```bash
   python3 train_1d.py --epochs 10  # –î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–µ–±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
   ```

4. **–°–æ–∑–¥–∞—Ç—å predict —Å–∫—Ä–∏–ø—Ç:**
   - –ê–Ω–∞–ª–æ–≥ `predict_keypoints.py` –¥–ª—è 1D CNN
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sliding window
   - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏–Ω–¥–µ–∫—Å—ã –∏ —Ü–µ–Ω—ã

5. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –¥–∞—à–±–æ—Ä–¥:**
   - –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏ (CNN –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –∏–ª–∏ 1D CNN)
   - –û–±–Ω–æ–≤–∏—Ç—å `labeling_dashboard.py`

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:**
   - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–µ–∫ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –∫ [0, 1]
   - X: –ø–æ–∑–∏—Ü–∏—è –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (0 = –Ω–∞—á–∞–ª–æ, 1 = –∫–æ–Ω–µ—Ü)
   - Y: –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞ (0 = min, 1 = max)

2. **–î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 100 —Å–≤–µ—á–µ–π
   - –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `sequence_length`
   - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω—å—à–µ, –¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω—É–ª—è–º–∏

3. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ –∏ —Ç–µ–∫—É—â–∏–π –ø–æ–¥—Ö–æ–¥
   - –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Ä–∞–∑–º–µ—Ç–∫–∏
   - –ú–æ–∂–Ω–æ –æ–±—É—á–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª—å—é

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è 1D CNN –¥–æ–ª–∂–Ω–∞:
- –†–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ —á–µ–º CNN –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ä–∞–≤–Ω–∏–º—É—é –∏–ª–∏ –ª—É—á—à—É—é —Ç–æ—á–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏
- –ë—ã—Ç—å –ø—Ä–æ—â–µ –≤ –æ—Ç–ª–∞–¥–∫–µ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
