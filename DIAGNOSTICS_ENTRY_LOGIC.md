# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ª–æ–≥–∏–∫–∏ –ø–æ–∏—Å–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏ –≤—Ö–æ–¥–∞ –≤ –ø–æ–∑–∏—Ü–∏—é

## üìã –û–±—â–∞—è —Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. –¶–∏–∫–ª —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (`service.py`)

```
–ö–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç (SCAN_INTERVAL = 60 * 10):
‚îú‚îÄ‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∞–∫—Ü–∏–π (TQBR)
‚îú‚îÄ‚îÄ –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞ (1h, 1d):
‚îÇ   ‚îú‚îÄ‚îÄ –î–ª—è –∫–∞–∂–¥–æ–π –∞–∫—Ü–∏–∏:
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π (get_candles_by_uid)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (EMA 7, EMA 14)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –ü–æ–∏—Å–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (scanner.analyze)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–∞–π–¥–µ–Ω:
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ (–∏–∑–±–µ–∂–∞–Ω–∏–µ –¥—É–±–ª–µ–π)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –≤—Ö–æ–¥–∞ (check_entry_signal)
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ –ï—Å–ª–∏ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚Üí –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
```

---

## üîç –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

### –°–∫–∞–Ω–µ—Ä –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (`ComplexFlagScanner`)

**–¢–∏–ø—ã –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:**
- **–ë—ã—á–∏–π —Ñ–ª–∞–≥** (FLAG): T0 ‚Üí T1 (—Ä–æ—Å—Ç), T1 ‚Üí T2 ‚Üí T3 ‚Üí T4 (–∫–æ—Ä—Ä–µ–∫—Ü–∏—è)
- **–ú–µ–¥–≤–µ–∂–∏–π —Ñ–ª–∞–≥** (BEARISH_FLAG): T0 ‚Üí T1 (–ø–∞–¥–µ–Ω–∏–µ), T1 ‚Üí T2 ‚Üí T3 ‚Üí T4 (–∫–æ—Ä—Ä–µ–∫—Ü–∏—è)

**–¢–æ—á–∫–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞:**
- **T0**: –ù–∞—á–∞–ª–æ —Ñ–ª–∞–≥—à—Ç–æ–∫–∞ (—ç–∫—Å—Ç—Ä–µ–º—É–º)
- **T1**: –ö–æ–Ω–µ—Ü —Ñ–ª–∞–≥—à—Ç–æ–∫–∞ (–ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–π —ç–∫—Å—Ç—Ä–µ–º—É–º)
- **T2**: –ü–µ—Ä–≤–∞—è —Ç–æ—á–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
- **T3**: –í—Ç–æ—Ä–∞—è —Ç–æ—á–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
- **T4**: –¢—Ä–µ—Ç—å—è —Ç–æ—á–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∞)

**–£—Å–ª–æ–≤–∏—è –ø–æ–∏—Å–∫–∞:**
- –ü–∞—Ç—Ç–µ—Ä–Ω —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞–π–¥–µ–Ω–Ω—ã–º, –∫–æ–≥–¥–∞ –≤—Å–µ —Ç–æ—á–∫–∏ T0-T4 –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- –°–∫–∞–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (`scan_type='all'` –¥–ª—è debug, `'latest'` –¥–ª—è prod)

---

## ‚úÖ –õ–æ–≥–∏–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø–æ–∑–∏—Ü–∏—é (EMA Squeeze)

### –ú–µ—Ç–æ–¥: `TradeStrategy.check_entry_signal_ema_squeeze()`

**–î–ª—è LONG (–±—ã—á–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω):**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–Ω–¥–∞:**
   ```
   EMA 7 > EMA 14  ‚úÖ (–≤–æ—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥)
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–æ–∂–µ–Ω–∏—è —Ü–µ–Ω—ã:**
   ```
   Close > EMA 7  ‚úÖ (—Ü–µ–Ω–∞ –≤—ã—à–µ –±—ã—Å—Ç—Ä–æ–π EMA)
   ```

3. **–†–∞—Å—á–µ—Ç –ª–∏–Ω–∏–∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è (T1-T3):**
   ```
   line_1_3_price = calculate_line_price(T1, T3, current_idx)
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ "–∑–∞–∂–∞—Ç–∏—è" —Ü–µ–Ω—ã:**
   ```
   EMA 7 < Close < line_1_3_price  ‚úÖ (—Ü–µ–Ω–∞ –º–µ–∂–¥—É EMA –∏ –ª–∏–Ω–∏–µ–π)
   ```

5. **–¢—Ä–∏–≥–≥–µ—Ä –≤—Ö–æ–¥–∞:**
   ```
   Close > Open  ‚úÖ (–∑–µ–ª–µ–Ω–∞—è —Å–≤–µ—á–∞ - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç—Å–∫–æ–∫–∞)
   ```

**–î–ª—è SHORT (–º–µ–¥–≤–µ–∂–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω):**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–Ω–¥–∞:**
   ```
   EMA 7 < EMA 14  ‚úÖ (–Ω–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥)
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–æ–∂–µ–Ω–∏—è —Ü–µ–Ω—ã:**
   ```
   Close < EMA 7  ‚úÖ (—Ü–µ–Ω–∞ –Ω–∏–∂–µ –±—ã—Å—Ç—Ä–æ–π EMA)
   ```

3. **–†–∞—Å—á–µ—Ç –ª–∏–Ω–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (T1-T3):**
   ```
   line_1_3_price = calculate_line_price(T1, T3, current_idx)
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ "–∑–∞–∂–∞—Ç–∏—è" —Ü–µ–Ω—ã:**
   ```
   line_1_3_price < Close < EMA 7  ‚úÖ (—Ü–µ–Ω–∞ –º–µ–∂–¥—É –ª–∏–Ω–∏–µ–π –∏ EMA)
   ```

5. **–¢—Ä–∏–≥–≥–µ—Ä –≤—Ö–æ–¥–∞:**
   ```
   Close < Open  ‚úÖ (–∫—Ä–∞—Å–Ω–∞—è —Å–≤–µ—á–∞ - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç—Å–∫–æ–∫–∞)
   ```

---

## üö´ –ü—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–∞–∑–∞ –≤–æ –≤—Ö–æ–¥–µ (–∏–∑ –ª–æ–≥–æ–≤)

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:

1. **"–ù–µ—Ç —Ç—Ä–µ–Ω–¥–∞ (EMA 7 <= EMA 14)"** (–¥–ª—è LONG)
   - **–ü—Ä–∏—á–∏–Ω–∞:** –í–æ—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω
   - **–†–µ—à–µ–Ω–∏–µ:** –ñ–¥–∞—Ç—å, –∫–æ–≥–¥–∞ EMA 7 –ø–µ—Ä–µ—Å–µ—á–µ—Ç EMA 14 –≤–≤–µ—Ä—Ö

2. **"–ù–µ—Ç —Ç—Ä–µ–Ω–¥–∞ (EMA 7 >= EMA 14)"** (–¥–ª—è SHORT)
   - **–ü—Ä–∏—á–∏–Ω–∞:** –ù–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω
   - **–†–µ—à–µ–Ω–∏–µ:** –ñ–¥–∞—Ç—å, –∫–æ–≥–¥–∞ EMA 7 –ø–µ—Ä–µ—Å–µ—á–µ—Ç EMA 14 –≤–Ω–∏–∑

3. **"–¶–µ–Ω–∞ –Ω–∏–∂–µ EMA 7"** (–¥–ª—è LONG)
   - **–ü—Ä–∏—á–∏–Ω–∞:** –¶–µ–Ω–∞ —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–æ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ª–æ–Ω–≥
   - **–†–µ—à–µ–Ω–∏–µ:** –ñ–¥–∞—Ç—å, –∫–æ–≥–¥–∞ —Ü–µ–Ω–∞ –ø–æ–¥–Ω–∏–º–µ—Ç—Å—è –≤—ã—à–µ EMA 7

4. **"–¶–µ–Ω–∞ –≤—ã—à–µ EMA 7"** (–¥–ª—è SHORT)
   - **–ü—Ä–∏—á–∏–Ω–∞:** –¶–µ–Ω–∞ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —à–æ—Ä—Ç
   - **–†–µ—à–µ–Ω–∏–µ:** –ñ–¥–∞—Ç—å, –∫–æ–≥–¥–∞ —Ü–µ–Ω–∞ –æ–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∏–∂–µ EMA 7

5. **"–¶–µ–Ω–∞ —É–∂–µ –ø—Ä–æ–±–∏–ª–∞ –ª–∏–Ω–∏—é 1-3 (–ø–æ–∑–¥–Ω–æ –¥–ª—è Squeeze –≤—Ö–æ–¥–∞)"** (–¥–ª—è LONG)
   - **–ü—Ä–∏—á–∏–Ω–∞:** –¶–µ–Ω–∞ —É–∂–µ –≤—ã—à–ª–∞ –∏–∑ –∑–æ–Ω—ã "–∑–∞–∂–∞—Ç–∏—è" (–≤—ã—à–µ –ª–∏–Ω–∏–∏ 1-3)
   - **–†–µ—à–µ–Ω–∏–µ:** –í—Ö–æ–¥ –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞ —Ü–µ–Ω–∞ –º–µ–∂–¥—É EMA –∏ –ª–∏–Ω–∏–µ–π

6. **"–¶–µ–Ω–∞ —É–∂–µ –ø—Ä–æ–±–∏–ª–∞ –ª–∏–Ω–∏—é 1-3 –≤–Ω–∏–∑"** (–¥–ª—è SHORT)
   - **–ü—Ä–∏—á–∏–Ω–∞:** –¶–µ–Ω–∞ —É–∂–µ –≤—ã—à–ª–∞ –∏–∑ –∑–æ–Ω—ã "–∑–∞–∂–∞—Ç–∏—è" (–Ω–∏–∂–µ –ª–∏–Ω–∏–∏ 1-3)
   - **–†–µ—à–µ–Ω–∏–µ:** –í—Ö–æ–¥ –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞ —Ü–µ–Ω–∞ –º–µ–∂–¥—É –ª–∏–Ω–∏–µ–π –∏ EMA

7. **"–°–≤–µ—á–∞ –Ω–µ –∑–µ–ª–µ–Ω–∞—è"** (–¥–ª—è LONG)
   - **–ü—Ä–∏—á–∏–Ω–∞:** –¢–µ–∫—É—â–∞—è —Å–≤–µ—á–∞ –∫—Ä–∞—Å–Ω–∞—è (Close <= Open)
   - **–†–µ—à–µ–Ω–∏–µ:** –ñ–¥–∞—Ç—å –∑–µ–ª–µ–Ω—É—é —Å–≤–µ—á—É –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

8. **"–°–≤–µ—á–∞ –Ω–µ –∫—Ä–∞—Å–Ω–∞—è"** (–¥–ª—è SHORT)
   - **–ü—Ä–∏—á–∏–Ω–∞:** –¢–µ–∫—É—â–∞—è —Å–≤–µ—á–∞ –∑–µ–ª–µ–Ω–∞—è (Close >= Open)
   - **–†–µ—à–µ–Ω–∏–µ:** –ñ–¥–∞—Ç—å –∫—Ä–∞—Å–Ω—É—é —Å–≤–µ—á—É –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

---

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –≤—Ö–æ–¥–∞ (`service.py`, —Å—Ç—Ä–æ–∫–∏ 364-430)

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫:

```python
1. enable_trading == True?  # –¢–æ—Ä–≥–æ–≤–ª—è –≤–∫–ª—é—á–µ–Ω–∞?
   ‚îî‚îÄ‚îÄ –ù–ï–¢ ‚Üí –ü—Ä–æ–ø—É—Å–∫

2. trade_manager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω?
   ‚îî‚îÄ‚îÄ –ù–ï–¢ ‚Üí –ü—Ä–æ–ø—É—Å–∫

3. strategy –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞?
   ‚îî‚îÄ‚îÄ –ù–ï–¢ ‚Üí –ü—Ä–æ–ø—É—Å–∫

4. check_entry_signal() ‚Üí (signal, desc, active_mode)
   ‚îú‚îÄ‚îÄ signal == True?
   ‚îÇ   ‚îú‚îÄ‚îÄ –î–ê ‚Üí –†–∞—Å—á–µ—Ç SL/TP ‚Üí open_position()
   ‚îÇ   ‚îî‚îÄ‚îÄ –ù–ï–¢ ‚Üí –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–∞–∑–∞
```

---

## üí∞ –õ–æ–≥–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏ (`TradeManager.open_position()`)

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ AI —Ñ–∏–ª—å—Ç—Ä–∞** (–µ—Å–ª–∏ `use_ai_filter=True`):
   ```
   AI –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏
   –ï—Å–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å < 50% ‚Üí –ø–æ–∑–∏—Ü–∏—è –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è
   ```

2. **–†–∞—Å—á–µ—Ç –æ–±—ä–µ–º–∞ –ø–æ–∑–∏—Ü–∏–∏:**
   ```
   risk_per_trade = 0.01 (1% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞)
   position_value = account_balance * risk_per_trade
   quantity_lots = position_value / (entry_price * lot_size)
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ dry_run:**
   ```
   dry_run == True ‚Üí –≠–º—É–ª—è—Ü–∏—è (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
   dry_run == False ‚Üí –†–µ–∞–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ä–¥–µ—Ä–∞ –≤ Tinkoff API
   ```

4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏:**
   ```
   trades_active.json ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
   –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–Ω—ç–ø—à–æ—Ç–∞ (CSV + JSON) –¥–ª—è ML
   ```

---

## üìä –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

- **`BOT_ENV`**: `debug` –∏–ª–∏ `prod`
- **`DRY_RUN`**: `True` (debug) –∏–ª–∏ `False` (prod)
- **`USE_AI_FILTER`**: `True` –∏–ª–∏ `False` (–∏–∑ docker-compose)
- **`DATA_DIR`**: `trading_bot` (debug) –∏–ª–∏ `trading_bot/data_prod` (prod)

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã TradeManager:

- **`risk_per_trade`**: 0.01 (1% —Ä–∏—Å–∫–∞ –Ω–∞ —Å–¥–µ–ª–∫—É)
- **`debug_mode`**: `True` (–≤—Å–µ–≥–¥–∞ 1 –ª–æ—Ç –¥–ª—è debug)
- **`commission_rate`**: 0.0004 (0.04%)

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: –ü–æ—á–µ–º—É –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ–∑–∏—Ü–∏–∏?

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –¢–æ—Ä–≥–æ–≤–ª—è –≤–∫–ª—é—á–µ–Ω–∞?

```bash
# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
"–¢–æ—Ä–≥–æ–≤–ª—è: –í–ö–õ–Æ–ß–ï–ù–ê"
```

**–ï—Å–ª–∏ "–û–¢–ö–õ–Æ–ß–ï–ù–ê":**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `--enable-trading` —Ñ–ª–∞–≥ –≤ docker-compose
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `enable_trading` –≤ service.py

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è?

```bash
# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
"üö© {ticker} [{tf}]: {pattern_type} —Ñ–ª–∞–≥ –Ω–∞–π–¥–µ–Ω!"
```

**–ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–∫–∞–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –£—Å–ª–æ–≤–∏—è –≤—Ö–æ–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è?

```bash
# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
"‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è –≤—Ö–æ–¥–∞ (EMA Squeeze –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞ T4)..."
```

**–ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `enable_trading == True`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `trade_manager` –∏ `strategy` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 4: AI —Ñ–∏–ª—å—Ç—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç?

```bash
# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
"ü§ñ AI –§–∏–ª—å—Ç—Ä: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å={prob}%"
"‚ùå AI –§–∏–ª—å—Ç—Ä –æ—Ç–∫–ª–æ–Ω–∏–ª —Å–¥–µ–ª–∫—É"
```

**–ï—Å–ª–∏ AI —Ñ–∏–ª—å—Ç—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç:**
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `USE_AI_FILTER=False` –≤ docker-compose
- –ò–ª–∏ —É–ª—É—á—à–∏—Ç—å ML –º–æ–¥–µ–ª—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 5: –£—Å–ª–æ–≤–∏—è EMA Squeeze –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è?

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã (–∏–∑ –ª–æ–≥–æ–≤):**

1. **"–ù–µ—Ç —Ç—Ä–µ–Ω–¥–∞"** - EMA 7 –∏ EMA 14 –Ω–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
2. **"–¶–µ–Ω–∞ —É–∂–µ –ø—Ä–æ–±–∏–ª–∞ –ª–∏–Ω–∏—é"** - –¶–µ–Ω–∞ –≤—ã—à–ª–∞ –∏–∑ –∑–æ–Ω—ã "–∑–∞–∂–∞—Ç–∏—è"
3. **"–°–≤–µ—á–∞ –Ω–µ –∑–µ–ª–µ–Ω–∞—è/–∫—Ä–∞—Å–Ω–∞—è"** - –ù–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–µ–π —Å–≤–µ—á–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ - —Å–∏—Å—Ç–µ–º–∞ –∂–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
- –ú–æ–∂–Ω–æ –æ—Å–ª–∞–±–∏—Ç—å —É—Å–ª–æ–≤–∏—è, –Ω–æ —ç—Ç–æ —É–≤–µ–ª–∏—á–∏—Ç —Ä–∏—Å–∫ –ª–æ–∂–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```python
logger.info(f"      üìä EMA 7: {ema7:.2f}, EMA 14: {ema14:.2f}")
logger.info(f"      üìä –¶–µ–Ω–∞: {close_price:.2f}, –õ–∏–Ω–∏—è 1-3: {line_1_3_price:.2f}")
logger.info(f"      üìä –°–≤–µ—á–∞: {'–∑–µ–ª–µ–Ω–∞—è' if close_price > open_price else '–∫—Ä–∞—Å–Ω–∞—è'}")
```

### 2. –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø—Ä–∏—á–∏–Ω–∞–º –æ—Ç–∫–∞–∑–∞:

```python
# –°—á–µ—Ç—á–∏–∫–∏ –ø—Ä–∏—á–∏–Ω –æ—Ç–∫–∞–∑–∞
rejection_reasons = {
    "–ù–µ—Ç —Ç—Ä–µ–Ω–¥–∞": 0,
    "–¶–µ–Ω–∞ –≤–Ω–µ –∑–æ–Ω—ã": 0,
    "–°–≤–µ—á–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç": 0
}
```

### 3. –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Å–ª–∞–±–∏—Ç—å —É—Å–ª–æ–≤–∏—è:

```python
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–æ–≥–æ—Å—Ç–∏
STRICT_MODE = True  # –°—Ç—Ä–æ–≥–∏–µ —É—Å–ª–æ–≤–∏—è
ALLOW_LATE_ENTRY = False  # –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ö–æ–¥ –ø–æ—Å–ª–µ –ø—Ä–æ–±–∏—Ç–∏—è –ª–∏–Ω–∏–∏
```

---

## üéØ –í—ã–≤–æ–¥—ã

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è
- ‚úÖ –£—Å–ª–æ–≤–∏—è –≤—Ö–æ–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
- ‚ö†Ô∏è –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç –ø—Ä–æ–≤–µ—Ä–∫—É EMA Squeeze

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–∞–∑–∞:**
1. –¶–µ–Ω–∞ —É–∂–µ –ø—Ä–æ–±–∏–ª–∞ –ª–∏–Ω–∏—é 1-3 (–ø–æ–∑–¥–Ω–æ –¥–ª—è –≤—Ö–æ–¥–∞)
2. –ù–µ—Ç —Ç—Ä–µ–Ω–¥–∞ (EMA 7 –∏ EMA 14 –Ω–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ)
3. –°–≤–µ—á–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

**–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** - —Å–∏—Å—Ç–µ–º–∞ –∂–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –¥–ª—è –≤—Ö–æ–¥–∞, —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤.
